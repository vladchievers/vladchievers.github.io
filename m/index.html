<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width,height=device-height,user-scalable=no,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <link rel="stylesheet" href="slick/slick-theme.css">
    <link rel="stylesheet" href="slick/slick.css">
    <meta charset="UTF-8">
    <title>Insert title here</title>


    <style>

    .close-modal{
       display: block;
       position: absolute;
       top: 10px;
       right: 10px;
       background: #fff;
       padding: 10px;
       color: #00366B;
   }
   .wrap-slider{
       position: relative;
       opacity: 0;
   }
   .image-list img{
       max-width: 100%;

   }
   .image-list .item{
    display: block;
    padding: 0 5px;
}
</style>


</head>
<body style="padding: 0px;">
    <script src="jquery.js" type="text/javascript"></script>
    <script src="slick.min.js"></script>>
    <script src="transform.js"></script>
    <script src="alloy_finger2.js" type="text/javascript"></script>
    <script src="to.js"></script>
    <script src="image_loaded.js"></script>


    <div id="imgBox" style="position:fixed;width: 100%;height: 100%;left:0;top:0;
    background:#fff;">
    <div class="close-modal" onclick="window.history.go(-1)">Закрыть</div>
    <img src="https://d25tv1xepz39hi.cloudfront.net/images/536-1.jpg" id="pinchImg" alt="" style="width: 100%;position: absolute; " />
    
    <div class="wrap-slider">
     <div class="image-list">
        <div>
            <a class="item img-zoom">
             <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTtN_8C0K0IowiDsKtm8qK3KBtDjbqfvb7rXlqs1CKZj4-_u5m5ug" alt="">
         </a>
     </div>
     <div>
         <a class="item img-zoom">
            <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQLHek_BY6d_dtwGLtYU5QWjJmWlZsG9LCsgN4PVAr6OqJhcu5C" alt="">
        </a>
    </div>
    <div>
     <a class="item img-zoom">
        <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTtN_8C0K0IowiDsKtm8qK3KBtDjbqfvb7rXlqs1CKZj4-_u5m5ug" alt="">
    </a>
</div>
<div>
 <a class="item img-zoom">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTtN_8C0K0IowiDsKtm8qK3KBtDjbqfvb7rXlqs1CKZj4-_u5m5ug" alt="">
</a>
</div>
<div>
 <a class="item img-zoom" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQLHek_BY6d_dtwGLtYU5QWjJmWlZsG9LCsgN4PVAr6OqJhcu5C">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQLHek_BY6d_dtwGLtYU5QWjJmWlZsG9LCsgN4PVAr6OqJhcu5C" alt="">
</a>
</div>
<div>
 <a class="item img-zoom" href="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTtN_8C0K0IowiDsKtm8qK3KBtDjbqfvb7rXlqs1CKZj4-_u5m5ug">
    <img src="https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTtN_8C0K0IowiDsKtm8qK3KBtDjbqfvb7rXlqs1CKZj4-_u5m5ug" alt="">
</a>
</div>
</div>
</div>

</div>


<script>
    $('.image-list').slick({
        slidesToShow: 3
    });


    $(function () {
      
      var top_slider = $(document).height()-90;
      $(".wrap-slider").css({
        top: top_slider,
        opacity: 1
      });

      $(".img-zoom").click(function() {
        $("#pinchImg").attr("src", $(this).attr("href"));
        new To(el, "scaleX", 1, 500, ease);
        new To(el, "scaleY", 1, 500, ease);
        new To(el, "translateX", 0, 500, ease);
        new To(el, "translateY", 0, 500, ease);
        imageLoaded("#pinchImg",function(w,h){
            document.querySelector("#imgBox").style.display="block";
            topPx=window.innerHeight/2-(h*window.innerWidth/w)/2;
            this.style.top=topPx+"px";
        });

        return false;
    });

  });
    var topPx;
    var startPx;
    imageLoaded("#pinchImg",function(w,h){
        document.querySelector("#imgBox").style.display="block";
        topPx=window.innerHeight/2-(h*window.innerWidth/w)/2;
        startPx = topPx;
        this.style.top=topPx+"px";
    });


    function ease(x) {
        return Math.sqrt(1 - Math.pow(x - 1, 2));
    }

    var el = document.getElementById("pinchImg");
    Transform(el);
    var initScale = 1;
    new AlloyFinger(el, {
        multipointStart: function () {
            To.stopAll();
            initScale = el.scaleX;
        },
    /*rotate: function (evt) {
        el.rotateZ += evt.angle;
    },*/
    pinch: function (evt) {
        el.scaleX = el.scaleY = initScale * evt.zoom;
    },
    multipointEnd: function () {
        To.stopAll();
        if (el.scaleX < 1) {

            new To(el, "scaleX", 1, 500, ease);
            new To(el, "scaleY", 1, 500, ease);
        }
        if (el.scaleX > 2) {

            new To(el, "scaleX", 2, 500, ease);
            new To(el, "scaleY", 2, 500, ease);
        }
        var rotation = el.rotateZ % 360;

        if (rotation < 0)rotation = 360 + rotation;
        el.rotateZ=rotation;

        if (rotation > 0 && rotation < 45) {
            new To(el, "rotateZ", 0, 500, ease);
        } else if (rotation >= 315) {
            new To(el, "rotateZ", 360, 500, ease);
        } else if (rotation >= 45 && rotation < 135) {
            new To(el, "rotateZ", 90, 500, ease);
        } else if (rotation >= 135 && rotation < 225) {
            new To(el, "rotateZ", 180, 500, ease);
        } else if (rotation >= 225 && rotation < 315) {
            new To(el, "rotateZ", 270, 500, ease);
        }
    },
    pressMove: function (evt) {
        el.translateX += evt.deltaX;
        el.translateY += evt.deltaY;
        evt.preventDefault();
    },
    tap: function (evt) {
        //console.log(el.scaleX + "_" + el.scaleY + "_" + el.rotateZ + "_" + el.translateX + "_" + el.translateY);
        //console.log("tap");
    },
    doubleTap: function (evt) {
        To.stopAll();
        if (el.scaleX > 1.5) {

            new To(el, "scaleX", 1, 500, ease);
            new To(el, "scaleY", 1, 500, ease);
            new To(el, "translateX", 0, 500, ease);
            new To(el, "translateY", 0, 500, ease);
        } else {
            var box = el.getBoundingClientRect();
            var y = box.height - (( evt.changedTouches[0].pageY - topPx) * 2) - (box.height / 2 - ( evt.changedTouches[0].pageY - topPx));

            var x = box.width - (( evt.changedTouches[0].pageX) * 2) - (box.width / 2 - ( evt.changedTouches[0].pageX));
            new To(el, "scaleX", 2, 500, ease);
            new To(el, "scaleY", 2, 500, ease);
            new To(el, "translateX", x, 500, ease);
            new To(el, "translateY", y, 500, ease);
        }
        //console.log("doubleTap");
    },
    longTap: function (evt) {
        //console.log("longTap");
    },
    swipe: function (evt) {
        //console.log("swipe" + evt.direction);
    }

});
</script>

</body>
</html>